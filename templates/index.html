<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Real-Time Emergency Alerts</title>

    <style>
        /* Make the body yellow and center everything vertically */
        body {
            background-color: #FFEB3B;
            margin: 0;
            padding: 0;
            height: 100vh;
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
        }
        /* Style for the black bar*/
        .header {
            background-color: black;
            color: #FFEB3B;
            width: 100%;
            padding: 20px 0;
            text-align: center;
            font-size: 32px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
         /* Style for the Client ID text */
        .client-id {
            margin-top: 20px;
            font-size: 24px;
            font-weight: bold;
            color: black;
            text-align: center;
        }

         /* Style for the chat box */
        #chat-box {
            background-color: black;
            color: white;
            width: 90%;
            max-width: 800px;
            height: 400px;
            margin-top: 20px;
            padding: 20px;
            overflow-y: auto;
            border: 5px solid black;
            border-radius: 10px;
            box-sizing: border-box;
        }

        /* Style for each individual chat message */
        .message {
            background-color: #424242;
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 5px;
            font-size: 16px;
        }

        /* Style for input box and send button */
        .input-area {
            margin-top: 20px;
            width: 90%;
            max-width: 800px;
            display: flex;
            gap: 10px;
        }
        input[type="text"] {
            flex-grow: 1;
            padding: 15px;
            font-size: 16px;
            border: 2px solid black;
            border-radius: 5px;
            box-sizing: border-box;
        }

        /* Style the Send button */
        button {
            background-color: black;
            color: #FFEB3B;
            padding: 15px 25px;
            font-size: 16px;
            font-weight: bold;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

         /* Style for button hover effect */
        button:hover {
            background-color: #333;
        }

        /* Style for the emergency icon*/
        .icon {
            font-size: 36px;
        }
    </style>
</head>

<body>

<!-- CONTENT -->
    <!-- Top header -->
    <div class="header">
        <span class="icon">ðŸš¨</span>
        REAL-TIME EMERGENCY ALERTS
        <span class="icon">ðŸš¨</span>
    </div>

    <!-- Client ID text appears -->
    <div class="client-id">Client #<span id="client-id">...</span> Connected</div>

    <!-- Chat area -->
    <div id="chat-box"></div>

    <!-- Input area -->
    <div class="input-area">
        <input id="messageInput" type="text" placeholder="Type an emergency update...">
        <button onclick="sendMessage()">Send</button>
    </div>

    <script>
        // Open a WebSocket connection to server
        const ws = new WebSocket(`ws://${location.host}/ws`);
    
        // Get references to chat box, input box, clientId
        const chatBox = document.getElementById('chat-box');
        const input = document.getElementById('messageInput');
        const clientIdSpan = document.getElementById('client-id');
    
        // When server sends a message
        ws.onmessage = (event) => {
            const message = event.data;
    
            // If message is client ID
            if (message.startsWith("ID: ")) {
                const clientId = message.slice(4).trim();
                clientIdSpan.textContent = clientId; // only update the number inside the <span>
            // if it's a chat message, display it in chat box
            } else {
                const messageDiv = document.createElement('div');
                messageDiv.className = "message";
                messageDiv.textContent = message;
                chatBox.appendChild(messageDiv);
                chatBox.scrollTop = chatBox.scrollHeight; //always scroll to latest message
            }
        };
    
        // Send message to server when "Send" button clicked
        function sendMessage() {
            if (input.value.trim() !== "") {
                ws.send(input.value.trim());
                input.value = '';
            }
        }
    
        // Press "Enter" key to send message
        input.addEventListener("keypress", function(event) {
            if (event.key === "Enter") {
                sendMessage();
            }
        });
    </script>
    
</body>
</html>
